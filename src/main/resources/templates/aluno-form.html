<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Formulário de Aluno</title>
    <style>
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input, select { width: 100%; max-width: 300px; padding: 5px; }
        .error { color: red; }
    </style>
</head>
<body>
<div th:if="${error}" class="error" th:text="${error}"></div>

<!-- Único formulário com ação dinâmica baseada em isNew -->
<form th:action="@{${isNew} ? '/alunos' : '/alunos/atualizar/' + ${aluno.id}}" th:method="post" th:object="${aluno}">
    <div class="form-group">
        <label for="nomeCompleto">Nome Completo:</label>
        <input type="text" id="nomeCompleto" th:field="*{nomeCompleto}" required />
        <div th:if="${#fields.hasErrors('nomeCompleto')}" class="error" th:errors="*{nomeCompleto}"></div>
    </div>

    <div class="form-group">
        <label for="email">Email:</label>
        <input type="email" id="email" th:field="*{email}" />
        <div th:if="${#fields.hasErrors('email')}" class="error" th:errors="*{email}"></div>
    </div>

    <div class="form-group">
        <label for="cpf">CPF:</label>
        <input type="text" id="cpf" th:field="*{cpf}" />
        <div th:if="${#fields.hasErrors('cpf')}" class="error" th:errors="*{cpf}"></div>
    </div>

    <div class="form-group">
        <label for="rg">RG:</label>
        <input type="text" id="rg" th:field="*{rg}" />
    </div>

    <div class="form-group">
        <label for="orgaoExpeditorRg">Órgão Expeditor RG:</label>
        <input type="text" id="orgaoExpeditorRg" th:field="*{orgaoExpeditorRg}" />
    </div>

    <div class="form-group">
        <label for="nacionalidade">Nacionalidade:</label>
        <input type="text" id="nacionalidade" th:field="*{nacionalidade}" />
    </div>

    <div class="form-group">
        <label for="uf">UF:</label>
        <input type="text" id="uf" th:field="*{uf}" />
    </div>

    <div class="form-group">
        <label for="telefone">Telefone:</label>
        <input type="text" id="telefone" th:field="*{telefone}" />
    </div>

    <div class="form-group">
        <label for="dataNascimento">Data de Nascimento:</label>
        <input type="date" id="dataNascimento" th:field="*{dataNascimento}" required />
        <div th:if="${#fields.hasErrors('dataNascimento')}" class="error" th:errors="*{dataNascimento}"></div>
    </div>

    <div class="form-group">
        <label for="nomeSocial">Nome Social:</label>
        <input type="text" id="nomeSocial" th:field="*{nomeSocial}" />
    </div>

    <div class="form-group">
        <label for="genero">Gênero:</label>
        <input type="text" id="genero" th:field="*{genero}" />
    </div>

    <div class="form-group">
        <label for="situacao">Situação:</label>
        <input type="text" id="situacao" th:field="*{situacao}" />
    </div>

    <div class="form-group">
        <label for="ultimoNivel">Último Nível:</label>
        <input type="text" id="ultimoNivel" th:field="*{ultimoNivel}" />
    </div>

    <div class="form-group">
        <label>Endereço:</label>
        <input type="text" th:field="*{endereco.logradouro}" placeholder="Logradouro" />
        <input type="text" th:field="*{endereco.numero}" placeholder="Número" />
        <input type="text" th:field="*{endereco.complemento}" placeholder="Complemento" />
        <input type="text" th:field="*{endereco.bairro}" placeholder="Bairro" />
        <input type="text" th:field="*{endereco.cidade}" placeholder="Cidade" />
        <input type="text" th:field="*{endereco.estado}" placeholder="Estado" />
        <input type="text" th:field="*{endereco.cep}" placeholder="CEP" />
        <div th:if="${#fields.hasErrors('endereco')}" class="error" th:errors="*{endereco}"></div>
    </div>

    <div class="form-group">
        <label for="grauParentesco">Grau de Parentesco:</label>
        <input type="text" id="grauParentesco" th:field="*{grauParentesco}" />
    </div>

    <div class="form-group">
        <label>Responsável Financeiro:</label>
        <input type="checkbox" id="responsavelFinanceiro" th:field="*{responsavelFinanceiro}" />
    </div>

    <div th:if="${aluno.responsavelFinanceiro}" class="form-group">
        <label for="nomeResponsavel">Nome do Responsável:</label>
        <input type="text" id="nomeResponsavel" th:field="*{nomeResponsavel}" />
        <div th:if="${#fields.hasErrors('nomeResponsavel')}" class="error" th:errors="*{nomeResponsavel}"></div>

        <label for="cpfResponsavel">CPF do Responsável:</label>
        <input type="text" id="cpfResponsavel" th:field="*{cpfResponsavel}" />
        <div th:if="${#fields.hasErrors('cpfResponsavel')}" class="error" th:errors="*{cpfResponsavel}"></div>

        <label for="telefoneResponsavel">Telefone do Responsável:</label>
        <input type="text" id="telefoneResponsavel" th:field="*{telefoneResponsavel}" />

        <label for="emailResponsavel">Email do Responsável:</label>
        <input type="email" id="emailResponsavel" th:field="*{emailResponsavel}" />
        <div th:if="${#fields.hasErrors('emailResponsavel')}" class="error" th:errors="*{emailResponsavel}"></div>
    </div>

    <div class="form-group">
        <label for="turmaIds">Turmas:</label>
        <select id="turmaIds" th:field="*{turmaIds}" multiple>
            <option th:each="turma : ${turmas}" th:value="${turma.id}" th:text="${turma.nomeTurma}"></option>
        </select>
    </div>

    <button type="submit">Salvar</button>
</form>

</body>
</html>